from typing import Any
import json
import time
import requests

from scrts import BOT_TOKEN, HYPIXEL_API_KEY, MONGODB_URI, RAGINGENBY_API_KEY

ITEMS: list[dict[str, Any]] = requests.get('https://api.ragingenby.dev/skyblock/items').json()['items']
PET_SKINS: set[str] = {
    item['id'] for item in ITEMS
    if item.get('id', '').startswith('PET_SKIN_')
}

USER_AGENT: str = "ChubBot"
TRADE_REPORT_FILE_PATH: str = "storage/tradereports.json"
TRADE_REPORT_VERIFICATION_CHANNEL: int = 1297080682517889045
TRADE_REPORT_CHANNEL: int = 1201283974924861470
RECENT_SALES_JURY_ROLE: int = 1284683682904539188
PRICE_CHECKER_ROLE: int = 937021859776589844
SUS_ACCOUNT_PING: str = "<@&1341256540740517930>"

HYPIXEL_GUILD_ID: str = "639d0c668ea8c9185c70caf9"

TICKET_TOOL_ID: int = 557628352828014614

RAGINGENBY_ID: int = 447861538095759365
THOMAS_ID: int = 230778630597246983
VINUSH_ID: int = 697136515461152768
FOE_ID: int = 758304690617712651
RAGINGENBY_MENTION: str = f"<@{RAGINGENBY_ID}>"

BOT_OWNERS: set[int] = {
    RAGINGENBY_ID,
    THOMAS_ID,
    FOE_ID,
    VINUSH_ID
}


STAFF_ROLE: int = 1244837447846592535
APPEAL_STAFF_ROLE: int = 1303852598952202302

VERIFICATION_CHANNEL: int = 1240047359946133624
VERIFICATION_LOG_CHANNEL: int = 1293009280261427330
STAFF_CHANNEL: int = 1183198328045977721
BOT_DEV_CHANNEL: int = 1263673819239809135
LOG_CHANNEL: int = 1264027690332323941

GUILD_ID: int = 934240413974417439
APPEAL_GUILD_ID: int = 1303484829639245914

VERIFIED_ROLE: int = 1240044060102623394
POSSIBLE_SCAMMER_ROLE: int = 935288721199214612
GUILD_MEMBER_ROLE: int = 1249863227014250527

DCTR_SPACE_HELM_ROLE: int = 1134970805810385017
RAFFLE_SPACE_HELM_ROLE: int = 1261200915109773405

# noinspection PyInterpreter
ITEM_ID_ROLES: dict[str, int] = {
    "POTATO_SILVER_MEDAL": 1295569723118981171,  # @Potato War Silver Medal
    "POTATO_CROWN": 1295569723118981171,  # @Potato War Silver Medal (this gives the same role because I wanted to for fun, but i cba to make a seperate role for it)
    "SHINY_RELIC": 1295569295195242586,  # @Shiny Relic
    "GAME_ANNIHILATOR": 1295563935096766485,  # @Game Annihilator
    "DEAD_BUSH_OF_LOVE": 1245118825746268190,  # @Dead Bush of Love*
    "KLOONBOAT": 1217172737160904715,  # @Kloonboat
    "CREATIVE_MIND": 1201988405420888155,  # @Creative Mind
    "GAME_BREAKER": 1221149287484887141,  # @Gamebreaker
    "POTATO_BASKET": 1261201356073603072,  # @Basket of Hope
    "ANCIENT_ELEVATOR": 1134970925784256572,  # @Ancient Elevator
    "SNOW_SNOWGLOBE": 1221630825830027325,  # @Snowglobe
    "PET_SKIN_GUARDIAN": 1296969495386128475,  # @Watcher Guardian
    "PET_SKIN_TIGER_TWILIGHT": 934261802815070269,  # @Twilight Tiger
    "PET_SKIN_RABBIT": 1310692785984241704,  # @Pretty Rabbit

    "WIKI_JOURNAL": 1296881300711538749,  # @Wiki Editor
    "EDITOR_PENCIL": 1296881300711538749,  # @Wiki Editor

    # You must have ALL of these items
    ','.join([
        "PET_SKIN_SHEEP_PURPLE", "PET_SKIN_SHEEP_WHITE", "PET_SKIN_SHEEP_LIGHT_BLUE",
        "PET_SKIN_SHEEP_LIGHT_GREEN", "PET_SKIN_SHEEP_PINK", "PET_SKIN_SHEEP_BLACK"
    ]): 934254703578079292,  # @OG Sheeps

    ','.join([
        "PET_SKIN_ROCK_COOL", "PET_SKIN_ROCK_THINKING", "PET_SKIN_ROCK_DERP",
        "PET_SKIN_ROCK_EMBARRASSED", "PET_SKIN_ROCK_LAUGH", "PET_SKIN_ROCK_SMILE"
    ]): 934254691796262992,  # @OG Rocks

    ','.join([
        "HOLY_BABY", "YOUNG_BABY", "STRONG_BABY",
        "UNSTABLE_BABY", "OLD_BABY", "WISE_BABY",
        "PROTECTOR_BABY", "SUPERIOR_BABY"
    ]): 934254704026857483,  # @Dragon Babies

    ','.join([
        "PET_SKIN_ELEPHANT_BLUE", "PET_SKIN_ELEPHANT_PINK", "PET_SKIN_ELEPHANT_ORANGE"
    ]): 934254929957224568,  # @OG Elephants

    ','.join([
        "PET_SKIN_SHEEP_NEON_BLUE", "PET_SKIN_SHEEP_NEON_GREEN", "PET_SKIN_SHEEP_NEON_RED",
        "PET_SKIN_SHEEP_NEON_YELLOW"
    ]): 1296961630227271680,  # @Neon Sheep

    ','.join([
        "PET_SKIN_SHEEP_LUNAR_GOAT", "PET_SKIN_TIGER_LUNAR", "PET_SKIN_HOUND_LUNAR",
        "PET_SKIN_PIGMAN_LUNAR_PIG", "PET_SKIN_RAT_LUNAR", "PET_SKIN_SCATHA_LUNAR_SNAKE",
        "PET_SKIN_DOLPHIN_LUNAR_HORSE", "PET_SKIN_MOOSHROOM_COW_LUNAR_OX", "PET_SKIN_ENDER_DRAGON_LUNAR",
        "PET_SKIN_RABBIT_LUNAR_BABY", "PET_SKIN_MONKEY_LUNAR", "PET_SKIN_CHICKEN_LUNAR_ROOSTER"
    ]): 1296962811221770303,  # @Lunar

    ','.join([
        "STORM_CELESTIAL", "GOLDOR_CELESTIAL", "MAXOR_CELESTIAL",
        "WITHER_GOGGLES_CELESTIAL", "NECRON_CELESTIAL"
    ]): 1296963411157975101,  # @Celestial Helmets

    ','.join([
        "HOLY_SHIMMER", "STRONG_SHIMMER", "SUPERIOR_SHIMMER",
        "WISE_SHIMMER", "UNSTABLE_SHIMMER", "PROTECTOR_SHIMMER",
        "YOUNG_SHIMMER", "OLD_SHIMMER"
    ]): 934255771162669107,  # @Shimmer Skins

    ','.join([
        "PET_SKIN_ELEPHANT_RED", "PET_SKIN_ELEPHANT_PURPLE", "PET_SKIN_ELEPHANT_GREEN"
    ]): 1296964784981282816,  # @Elephant Heirs

    ','.join([
        "PET_SKIN_SHEEP_PURPLE_CRUSHED", "PET_SKIN_SHEEP_PINK_CRUSH", "PET_SKIN_SHEEP_BLUE_CRUSH",
        "PET_SKIN_SHEEP_BLACK_CHROMATIC_CRUSH"
    ]): 1296961528943349760,  # @Crush Sheep

    ','.join([
        "MAGIC_CUBE_FLUX", "GOLDEN_ANCIENT_EGG_FLUX", "PIRATE_BOMB_FLUX",
        "GLISTENING_MELON_FLUX", "GOLDEN_APPLE_FLUX", "GLOWING_GRAPE_FLUX",
        "MYSTIC_MOON_FLUX", "BEACH_BALL_FLUX", "CHERRY_BLOSSOM_FLUX", "POLAR_LIGHTS_FLUX"
    ]): 1132783153044529283,  # @Power Orb Skins

    ','.join([
        "PET_SKIN_JERRY_GREEN_ELF", "PET_SKIN_JERRY_RED_ELF"
    ]): 1218028528298102834,  # @Jerry Skins

    ','.join([
        "PET_SKIN_ENDERMAN", "PET_SKIN_ENDERMAN_SLAYER", "PET_SKIN_ENDERMAN_NEBULA",
        "PET_SKIN_ENDERMAN_SUN", "PET_SKIN_ENDERMAN_BLUE_MOON", "PET_SKIN_ENDERMAN_NEON",
        "PET_SKIN_ENDERMAN_XENON"
    ]): 1310693495970988135,  # @Enderman Skins

    ','.join([
       "PET_SKIN_BEE_HIVE", "PET_SKIN_BEE_HONEY", "PET_SKIN_BEE_USB",
        "PET_SKIN_BEE_RUGBEE", "PET_SKIN_BEE_ZOMBEE", "PET_SKIN_BEE_WANNA_BEE",
        "PET_SKIN_BEE_GREAT_GATSBEE", "PET_SKIN_BEE_BEELOVED", "PET_SKIN_BEE_WASABEE",
        "PET_SKIN_BEE_BEEDAZZLED", "PET_SKIN_BEE_RGBEE", "PET_SKIN_BEE_SPELLING_BEE"
    ]): 1310693793586217081, # @Bee Skins

    ','.join([
        "PET_SKIN_RAT_NINJA", "PET_SKIN_RAT_SQUEAKHEART", "PET_SKIN_RAT_SECRAT_SERVICE",
        "PET_SKIN_RAT_JUNK_RAT", "PET_SKIN_RAT_RAT-STRONAUT", "PET_SKIN_RAT_LUNAR",
        "PET_SKIN_RAT_KARATE", "PET_SKIN_RAT_PIRATE", "PET_SKIN_RAT_MR_CLAWS",
        "PET_SKIN_RAT_GYM_RAT", "PET_SKIN_RAT_SECURATY_GUARD", "PET_SKIN_RAT_HIDE_AND_SQUEAK"
    ]): 1310694980968382525,  # @Rat Skins

    ','.join([
        "PET_SKIN_PHEONIX_FLAMINGO", "PET_SKIN_CHICKEN_ROAST", "UNSTABLE_DRAGON_DRAKE",
        "PET_SKIN_WOLF_ZODIAC", "BAG_OF_COAL_BACKPACK", "GLOSSY_MINERAL_HELMET_ROYAL",
        "PET_SKIN_SKELETON_PEARL", "PET_SKIN_MOOSHROOM_COW_LUNAR_OX", "PET_SKIN_RAT_LUNAR",
        "CHRISTMAS_STOCKING_BACKPACK", "PET_SKIN_REINDEER_RED_NOSE", "AWAKENED_EYE_BACKPACK",
        "PET_SKIN_CHICKEN_ZODIAC_ROOSTER", "PET_SKIN_LION_HEART", "MYSTIC_MOON_FLUX",
        "BEACH_BALL_FLUX", "PET_SKIN_SHEEP_LUNAR_GOAT", "PET_SKIN_BLUE_WHALE_PLUSHIE",
        "CHERRY_BLOSSOM_FLUX", "PET_SKIN_JERRY_KING", "PET_SKIN_SHEEP_BLACK_CHROMATIC_CRUSH",
        "PET_SKIN_PIGMAN_ZODIAC_PIG", "PET_SKIN_HOUND_LUNAR", "PET_SKIN_SNOW_OWL",
        "PET_SKIN_SCATHA_LUNAR_SNAKE", "MAIN_STREET_BARN_SKIN", "PET_SKIN_TIGER_LUNAR",
        "WATER_HYDRA_BABY", "BEAUTIFALL_CABIN_BARN_SKIN", "PROTECTOR_DRAGON_DRAKE",
        "YOUNG_DRAGON_DRAKE", "PET_SKIN_GHOUL_GHOULFRIEND", "WINTER_HOMESTEAD_BARN_SKIN",
        "PET_SKIN_MEGALODON_PINK_PLUSHIE", "PET_SKIN_JERRY_FROZEN", "POLAR_NIGHTS_POWER_FLUX",
        "PET_SKIN_MONKEY_LUNAR", "PET_SKIN_REINDEER_ZODIAC_HORSE", "WATER_HYDRA_DRAGON",
        "BEACH_BALL_BARN_SKIN", "PET_SKIN_IRON_GOLEM_CLAY", "PET_SKIN_MONKEY_ZODIAC",
        "PET_SKIN_WOLF_SPIRIT", "PET_SKIN_SHEEP_BLUE_CRUSH", "PET_SKIN_DOLPHIN_LUNAR_HORSE",
        "ENCHANTED_NOOK_BARN_SKIN", "PET_SKIN_WOLF_GERMAN", "PET_SKIN_WOLF_DOGE_PLUSHIE",
        "REKINDLED_EMBER_BURNING", "PET_SKIN_TIGER_ZODIAC", "PET_SKIN_SHEEP_PURPLE_CRUSHED",
        "DYE_SNOWFLAKE", "PET_SKIN_GOLDEN_DRAGON_SWAP_PLUSHIE", "SUPERIOR_DRAGON_DRAKE",
        "PET_SKIN_RABBIT_ZODIAC", "HOLY_DRAGON_DRAKE", "HAMBAGGER_BACKPACK",
        "PET_SKIN_SHEEP_ZODIAC_GOAT", "PET_SKIN_GRIFFIN_BALD_EAGLE", "PET_SKIN_ENDER_DRAGON_LUNAR",
        "PET_SKIN_MONKEY_SOCK", "NECRON_DIAMOND_KNIGHT", "WISE_DRAGON_DRAKE",
        "PET_SKIN_TYRANNOSAURUS_PLUSHIE", "PET_SKIN_GRIFFIN_PEAFOWL", "PET_SKIN_RABBIT_LUNAR_BABY",
        "PET_SKIN_ROCK_HOLLOW", "PET_SKIN_BLAZE_PLUSHIE", "HOT_COCOA_BACKPACK",
        "PET_SKIN_SCATHA_ZODIAC_SNAKE", "PET_SKIN_SHEEP_PINK_CRUSH", "DIVER_FROZEN",
        "PET_SKIN_ENDER_DRAGON_ZODIAC", "PET_SKIN_TIGER_PLUSHIE", "PET_SKIN_PARROT_CROW",
        "TOWN_HALL_BARN_SKIN", "DYE_BLACK_ICE", "STRONG_DRAGON_DRAKE",
        "BACKPACK_CAT_O_LANTERN", "OLD_DRAGON_DRAKE", "PET_SKIN_MOOSHROOM_COW_MYCELIYUM_BURGER",
        "PET_SKIN_ENDER_DRAGON_SWAP_PLUSHIE", "PET_SKIN_CHICKEN_LUNAR_ROOSTER", "PET_SKIN_SNOWMAN_COOKIE_SANDWICH",
        "PET_SKIN_PARROT_TOUCAN", "PET_SKIN_PIGMAN_BBQ", "PET_SKIN_PIGMAN_LUNAR_PIG",
        "FROZEN_BLAZE_ICEBERG", "PET_SKIN_RAT_ZODIAC", "POLAR_LIGHTS_FLUX"
    ]): 1341449664670601327,  # @Remarkable Taylor Collector
}

RANK_ROLES: dict[str, int] = {
    "YOUTUBER": 935002292791427092, # @Content Creator
    "STAFF": 1295140666640171018, # @Hypixel Staff
    "NORMAL": 1341460040128659576, # @Ex Staff/YT Rank (just a role for ragingenby to view a list lol)
}

REQUIRES_VERIFICATION: list[int] = [
    VERIFIED_ROLE,
    GUILD_MEMBER_ROLE,
    DCTR_SPACE_HELM_ROLE,
    RAFFLE_SPACE_HELM_ROLE
]\
    + list(ITEM_ID_ROLES.values())\
    + list(RANK_ROLES.values())


while True:
    print('getting guild data...')
    response = requests.get(
        'https://api.hypixel.net/v2/guild',
        params={
            "key": HYPIXEL_API_KEY,
            "id": HYPIXEL_GUILD_ID
        },
        headers={'User-Agent': USER_AGENT}
    )
    if response.status_code != 200:
        print(response.status_code, json.dumps(response.json(), indent=2))
        time.sleep(2)
        continue
    break
guild_members: list[str] = [member['uuid'] for member in response.json()['guild']['members']]
